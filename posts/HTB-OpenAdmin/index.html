<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hack The Box - OpenAdmin" /><meta property="og:locale" content="en" /><meta name="description" content="This write-up is an attempt to show my process of achieving root in the HackTheBox machine OpenAdmin." /><meta property="og:description" content="This write-up is an attempt to show my process of achieving root in the HackTheBox machine OpenAdmin." /><link rel="canonical" href="https://tid4l.github.io/posts/HTB-OpenAdmin/" /><meta property="og:url" content="https://tid4l.github.io/posts/HTB-OpenAdmin/" /><meta property="og:site_name" content="TidalSec" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-27T13:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - OpenAdmin" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2020-03-27T13:00:00-05:00","datePublished":"2020-03-27T13:00:00-05:00","description":"This write-up is an attempt to show my process of achieving root in the HackTheBox machine OpenAdmin.","headline":"Hack The Box - OpenAdmin","mainEntityOfPage":{"@type":"WebPage","@id":"https://tid4l.github.io/posts/HTB-OpenAdmin/"},"url":"https://tid4l.github.io/posts/HTB-OpenAdmin/"}</script><title>Hack The Box - OpenAdmin | TidalSec</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TidalSec"><meta name="application-name" content="TidalSec"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avi/avi.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">TidalSec</a></div><div class="site-subtitle font-italic">Cybersecurity.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/tid4l" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack The Box - OpenAdmin</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hack The Box - OpenAdmin</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Chris</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1585332000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-03-27 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1644 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>This write-up is an attempt to show my process of achieving root in the HackTheBox machine <em>OpenAdmin</em>.</p><hr /><blockquote class="prompt-warning"><div><p>These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t attest to the accuracy of my thoughts.</p></div></blockquote><p><img data-src="/assets/img/posts/htb/03-2020/info.PNG" alt="" data-proofer-ignore> <em>Task: Find <a href="#user-flag">user.txt</a> and <a href="#root-flag">root.txt</a></em></p><h2 id="penetration-methodologies"><span class="mr-2">Penetration Methodologies</span><a href="#penetration-methodologies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Scanning</strong></p><ul><li>nmap</ul><p><strong>Enumeration</strong></p><ul><li>dirbuster</ul><p><strong>Exploitation</strong></p><ul><li>Known CVE (ona)</ul><p><strong>Priv Esc</strong></p><ul><li><p>Port Forwarding</p><li><p>GTFOBins</p></ul><p>This was my first “start-to-finish” CTF challenge, and I learned a ton of new techniques and tools as I slowly picked my way through the box. As my first rooted machine, this was challenging, and I’m sure others will find success much faster than myself. Regardless, I wanted to take this opportunity to capture my methods and thought processes as I begin to delve into the CTF realm, while hopefully helping those struggling to find the next step.</p><h2 id="user-flag"><span class="mr-2">User Flag</span><a href="#user-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We start by scanning the <em>OpenAdmin</em> machine using nmap. I generally output my scan to a text file for portability and easier access later.</p><ul><li><p><strong>sV</strong>: version and service on the port</p><li><p><strong>A</strong>: the OS version and other things</p><li><p><strong>O</strong>: remote OS detection using fingerprinting</p><li><p><strong>script=banner</strong>: banner information</p></ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="c"># Nmap 7.80 scan initiated Sun Mar 29 12:33:17 2020 as: nmap -A -O -sV --script=banner -oN scan171.txt 10.10.10.171</span>
Nmap scan report <span class="k">for </span>10.10.10.171
Host is up <span class="o">(</span>0.22s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
|_banner: SSH-2.0-OpenSSH_7.6p1 Ubuntu-4ubuntu0.3
80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
No exact OS matches <span class="k">for </span>host <span class="o">(</span>If you know what OS is running on it, see https://nmap.org/submit/ <span class="o">)</span><span class="nb">.</span>
TCP/IP fingerprint:
OS:SCAN<span class="o">(</span><span class="nv">V</span><span class="o">=</span>7.80%E<span class="o">=</span>4%D<span class="o">=</span>3/29%OT<span class="o">=</span>22%CT<span class="o">=</span>1%CU<span class="o">=</span>35893%PV<span class="o">=</span>Y%DS<span class="o">=</span>2%DC<span class="o">=</span>T%G<span class="o">=</span>Y%TM<span class="o">=</span>5E80DC3
OS:B%P<span class="o">=</span>x86_64-pc-linux-gnu<span class="o">)</span>SEQ<span class="o">(</span><span class="nv">SP</span><span class="o">=</span>FE%GCD<span class="o">=</span>1%ISR<span class="o">=</span>108%TI<span class="o">=</span>Z%CI<span class="o">=</span>Z%II<span class="o">=</span>I%TS<span class="o">=</span>A<span class="o">)</span>OPS<span class="o">(</span>
OS:O1<span class="o">=</span>M54DST11NW7%O2<span class="o">=</span>M54DST11NW7%O3<span class="o">=</span>M54DNNT11NW7%O4<span class="o">=</span>M54DST11NW7%O5<span class="o">=</span>M54DST11
OS:NW7%O6<span class="o">=</span>M54DST11<span class="o">)</span>WIN<span class="o">(</span><span class="nv">W1</span><span class="o">=</span>7120%W2<span class="o">=</span>7120%W3<span class="o">=</span>7120%W4<span class="o">=</span>7120%W5<span class="o">=</span>7120%W6<span class="o">=</span>7120<span class="o">)</span>ECN<span class="o">(</span>
OS:R<span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>7210%O<span class="o">=</span>M54DNNSNW7%CC<span class="o">=</span>Y%Q<span class="o">=)</span>T1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%S<span class="o">=</span>O%A<span class="o">=</span>S+%F<span class="o">=</span>AS
OS:%RD<span class="o">=</span>0%Q<span class="o">=)</span>T2<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T3<span class="o">(</span><span class="nv">R</span><span class="o">=</span>N<span class="o">)</span>T4<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T5<span class="o">(</span><span class="nv">R</span><span class="o">=</span>
OS:Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T6<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>A%A<span class="o">=</span>Z%F<span class="o">=</span>
OS:R%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>T7<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>Y%T<span class="o">=</span>40%W<span class="o">=</span>0%S<span class="o">=</span>Z%A<span class="o">=</span>S+%F<span class="o">=</span>AR%O<span class="o">=</span>%RD<span class="o">=</span>0%Q<span class="o">=)</span>U1<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DF<span class="o">=</span>N%T
OS:<span class="o">=</span>40%IPL<span class="o">=</span>164%UN<span class="o">=</span>0%RIPL<span class="o">=</span>G%RID<span class="o">=</span>G%RIPCK<span class="o">=</span>G%RUCK<span class="o">=</span>G%RUD<span class="o">=</span>G<span class="o">)</span>IE<span class="o">(</span><span class="nv">R</span><span class="o">=</span>Y%DFI<span class="o">=</span>N%T<span class="o">=</span>40%CD<span class="o">=</span>
OS:S<span class="o">)</span>

Network Distance: 2 hops
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

TRACEROUTE <span class="o">(</span>using port 3306/tcp<span class="o">)</span>
HOP RTT      ADDRESS
1   58.26 ms 10.10.14.1
2   58.10 ms 10.10.10.171

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
<span class="c"># Nmap done at Sun Mar 29 12:34:51 2020 -- 1 IP address (1 host up) scanned in 94.69 seconds</span>
</pre></table></code></div></div><p>Two ports came back open, port 22 (SSH) and port 80 (HTTP). Port 80 indicated to me that this machine is a webserver. Without the information already being available to me on the HackTheBox webpage, I can also infer that this is a Linux machine based on the results. Since I don’t have any usernames or passwords, SSH doesn’t seem like the best route right now, so let’s focus our attention on the webserver.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>80/tcp open  http    Apache httpd 2.4.29 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-server-header: Apache/2.4.29 <span class="o">(</span>Ubuntu<span class="o">)</span>
</pre></table></code></div></div><p>We’ll navigate to the web page successfully. The machine is hosting Apache2 and is currently displaying the default page for its home:</p><p><img data-src="/assets/img/posts/htb/03-2020/webpage.PNG" alt="" data-proofer-ignore></p><p>With some research, we can find there are a few tools available to enumerate webserver directories. One being <code class="language-plaintext highlighter-rouge">DirBuster</code>, which can brute-force directories. Let’s boot it up, add the target URL, and select the directory-list-1.0. The <code class="language-plaintext highlighter-rouge">list info</code> button can provide good information on which list is appropriate. Once we have our settings, we’ll press start:</p><p><img data-src="/assets/img/posts/htb/03-2020/dirb1.PNG" alt="" data-proofer-ignore></p><p><img data-src="/assets/img/posts/htb/03-2020/dirb2.PNG" alt="" data-proofer-ignore></p><p>Pretty quickly the results start to come in and we can see that one link is not standard. <code class="language-plaintext highlighter-rouge">/ona</code> looks promising and received a 200 response, which indicates a successful HTTP request. Ona is the home directory for a project called <a href="https://github.com/opennetadmin/ona">OpenNetAdmin</a>. At this point, we can pause DirBuster and navigate to <code class="language-plaintext highlighter-rouge">http://10.10.10.171/ona/</code> to see what we can find:</p><p><img data-src="/assets/img/posts/htb/03-2020/ona.PNG" alt="" data-proofer-ignore></p><p>Okay, we now have a bit of a peak behind the curtain, and one thing on this page really stands out: we now know their current version number for ona, and it looks like it may be unpatched. At this point, we can search metasploit for opennetadmin 18.1. Our search returns a single exploit, a ping command injection:</p><p><img data-src="/assets/img/posts/htb/03-2020/meta1.PNG" alt="" data-proofer-ignore></p><p>Our next step is to determine if this exploit will work in this specific scenario, so we’ll run the options command to view a more detailed synopsis. We can see that the version running on the machine falls within the vulnerable versions:</p><p><img data-src="/assets/img/posts/htb/03-2020/meta2.PNG" alt="" data-proofer-ignore></p><p>Okay, everything looks to be in order, we’ll build out our exploit, setting the target host and selecting the linux meterpreter payload.</p><p><img data-src="/assets/img/posts/htb/03-2020/meta3.PNG" alt="" data-proofer-ignore></p><p>When we run the exploit, we can see it create a meterpreter session. Success! We have now gained a foothold within the machine. Now to see if we can find anything of use. Primarily, we know we need to find a way to escalate my privileges. Within the context of these HackTheBox CTFs, that means gaining access to a user account first.</p><p><img data-src="/assets/img/posts/htb/03-2020/meta4.PNG" alt="" data-proofer-ignore></p><p>After getting our bearings, we’ll open a shell session from meterpreter. we’ll cat <code class="language-plaintext highlighter-rouge">/etc/passwd</code>, which reveals a list of users. The two that we will make note of are jimmy and joanna.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>jimmy:x:1000:1000:jimmy:/home/jimmy:/bin/bash
joanna:x:1001:1001:,,,:/home/joanna:/bin/bash
</pre></table></code></div></div><p>While enumerating the file system, we find a file named <code class="language-plaintext highlighter-rouge">database_settings.inc.php</code> within the <code class="language-plaintext highlighter-rouge">/config</code> folder. When I open it I find a password for the database: n1nj4W4rri0R!.</p><p><img data-src="/assets/img/posts/htb/03-2020/db.PNG" alt="" data-proofer-ignore></p><p>We’ll take note of the password. Since many people reuse passwords across services, it’s worth an attempt to see if johnny or joanna have done the same.</p><p>From our scan earlier, we noted that port 22, SSH, was also open. We have a couple usernames, and we have a potential password, it’s time to see if we can establish an SSH connection.</p><p>We can successfully connect with user jimmy first! We have escalated privileges. The first flag on the HackTheBox machines are within the user’s home folder, so let’s check jimmy’s, with no luck. We need to gain access to the user joanna.</p><p><img data-src="/assets/img/posts/htb/03-2020/ssh.PNG" alt="" data-proofer-ignore></p><p>Next, we’ll run the <code class="language-plaintext highlighter-rouge">netstat</code> command and find that the <em>OpenAdmin</em> machine is hosting something on <code class="language-plaintext highlighter-rouge">127.0.0.1:52846</code>. We should try to gain access to this service.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>tcp	0	0 127.0.0.1:52846	0.0.0.0:*	LISTEN
</pre></table></code></div></div><p>We need to accomplish remote port forwarding. By utilizing SSH tunneling, we can access the port on <em>OpenAdmin</em> remotely. I learned a lot about this topic from <a href="https://linuxize.com/post/how-to-setup-ssh-tunneling/">linuxize</a>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>ssh <span class="nt">-L</span> 52846:localhost:52846 jimmy@10.10.10.171
</pre></table></code></div></div><p>Next, we’ll open my web browser and navigate to <code class="language-plaintext highlighter-rouge">localhost:52846</code>. We connect successfully, but it looks like jimmy took extra precautions, the page appears to be protected by a login.</p><p><img data-src="/assets/img/posts/htb/03-2020/login.PNG" alt="" data-proofer-ignore></p><p>We may recall seeing some unrelated webpages when we were poking around on the SSH session as jimmy before. Let’s look at this file again to see if it has something that could help us out here. Using the <code class="language-plaintext highlighter-rouge">find</code> command, we locate a <code class="language-plaintext highlighter-rouge">index.php</code> in the <code class="language-plaintext highlighter-rouge">/www/internal</code> directory and view it.</p><p>Within the <code class="language-plaintext highlighter-rouge">index.php</code> file we find the html <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> tag containing the login form. This form has an embedded php script that checks the login and password directly, and we can plainly see the login and the hashed password, which is hashed with with SHA512.</p><p><img data-src="/assets/img/posts/htb/03-2020/hash.PNG" alt="" data-proofer-ignore></p><p>Let’s grab the password hash and navigate to a website that can crack SHA512 hashes, hoping that the password isn’t too complex. Fortunately, the password is quickly “Revealed”.</p><p><img data-src="/assets/img/posts/htb/03-2020/revealed.PNG" alt="" data-proofer-ignore></p><p>We’ll return to the index page and attempt the username, jimmy, and the new password.</p><p>We successfully log in, where we find an RSA private key, presumedly belonging to joanna, for whatever reason. We’ll copy the RSA key to a text file.</p><p><img data-src="/assets/img/posts/htb/03-2020/rsa.PNG" alt="" data-proofer-ignore></p><p>To use this key, we’ll start with <code class="language-plaintext highlighter-rouge">ssh2john.py</code> to hash the newly attained RSA key and then use <code class="language-plaintext highlighter-rouge">john</code> in conjunction with the word list <code class="language-plaintext highlighter-rouge">rockyou.txt</code> to crack the pass phrase bloodninjas.</p><p><img data-src="/assets/img/posts/htb/03-2020/john1.PNG" alt="" data-proofer-ignore></p><p><img data-src="/assets/img/posts/htb/03-2020/john2.PNG" alt="" data-proofer-ignore></p><p>Before attempting to SSH, we need to change the permissions on the text file containing the private RSA key.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">chmod </span>600 rsa_key.txt
</pre></table></code></div></div><p>Now, we are ready to attempt to connect to the machine with user joanna; we have a username, potentially a key, and a passphrase. We attempt SSH, and success! We’re now connected as joanna.</p><p><img data-src="/assets/img/posts/htb/03-2020/ssh2.PNG" alt="" data-proofer-ignore></p><p>Let’s grab the first flag from joanna’s home directory. Now on to root!</p><p><img data-src="/assets/img/posts/htb/03-2020/user-flag.PNG" alt="" data-proofer-ignore></p><h2 id="root-flag"><span class="mr-2">Root Flag</span><a href="#root-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we are connected as joanna, we’ll run the command <code class="language-plaintext highlighter-rouge">sudo -l</code>, which lists the user’s allowed commands and privileges. In this case, joanna can run the <code class="language-plaintext highlighter-rouge">/bin/nano</code> command on the <code class="language-plaintext highlighter-rouge">/opt/priv</code> text file as root, without root’s password.</p><p>We’ll run the command with sudo, and find ourselves within a text file, with potentially escalated privileges.</p><p><img data-src="/assets/img/posts/htb/03-2020/sudo2.PNG" alt="" data-proofer-ignore></p><p>Using <a href="https://gtfobins.github.io/">GTFOBins</a>, a “curated list of Unix binaries that can be exploited by an attacker to bypass local security restrictions”, we may be able to spawn a shell with escalated privileges. We’ll attempt the commands from the site within the nano session:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>^R^X
reset<span class="p">;</span> sh 1&gt;&amp;0 2&gt;&amp;0
</pre></table></code></div></div><p>Success! It’s difficult to see, but we successfully spawned a shell session. We can now grab the final flag and complete <em>OpenAdmin</em>!</p><p><img data-src="/assets/img/posts/htb/03-2020/root-flag.PNG" alt="" data-proofer-ignore></p><hr /><h2 id="mitigations"><span class="mr-2">Mitigations</span><a href="#mitigations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><p>Security through obscurity is not a best practice. If a network administration tool like ONA must be public facing it should be secured through consistent updates. Enumerating directories is a simple task for an attacker and finding hidden directories is not difficult.</p><li><p>Password re-use can have some unintended consequences. For example, password for a database should not be the same as the password used to remotely connect to a system, especially when that password can be found in cleartext on the system. A good password policy can help prevent this.</p><li><p>Allowing users to be able to run certain commands with elevated privileges should be carefully considered. It might be necessary for a user to perform a duty and does comply with the principle of Least Privileged, but as <a href="https://gtfobins.github.io/">GTFOBins</a> demonstrates, it can be abused.</p></ul><h2 id="final-thoughts"><span class="mr-2">Final Thoughts</span><a href="#final-thoughts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Overall, I had a lot of fun with this box and I learned a ton. It was slow going at times, but I feel that I will certainly use the techniques I covered here going forward. The range of tools and concepts required to root this box was certainly beneficial and seeing some of them in action really drove their purpose home.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hack-the-box/'>Hack the Box</a>, <a href='/categories/linux/'>Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack The Box - OpenAdmin - TidalSec&amp;url=https://tid4l.github.io/posts/HTB-OpenAdmin/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack The Box - OpenAdmin - TidalSec&amp;u=https://tid4l.github.io/posts/HTB-OpenAdmin/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://tid4l.github.io/posts/HTB-OpenAdmin/&amp;text=Hack The Box - OpenAdmin - TidalSec" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/First-Post-and-Obligatory-Blog-Walkthrough/">First Post and Obligatory Blog Walkthrough</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/discovery/">discovery</a> <a class="post-tag" href="/tags/edr/">edr</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTB-Tabby/"><div class="card-body"> <em class="timeago small" data-ts="1593626400" > 2020-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Tabby</h3><div class="text-muted small"><p> This is my write up for the HackTheBox Linux machine Tabby. These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t at...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Cache/"><div class="card-body"> <em class="timeago small" data-ts="1593885600" > 2020-07-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Cache</h3><div class="text-muted small"><p> This is my guide to the HackTheBox Linux machine Cache. These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’t attest...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Traceback/"><div class="card-body"> <em class="timeago small" data-ts="1588010400" > 2020-04-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack the Box - Traceback</h3><div class="text-muted small"><p> This is my write up for the HackTheBox Linux machine Traceback. These HTB writeups have been migrated from a standalone repository for ease of access. However, I wrote these to learn and can’...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/HTB-ServMon/" class="btn btn-outline-primary" prompt="Newer"><p>Hack The Box - ServMon</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Chris</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/c/">c</a> <a class="post-tag" href="/tags/discovery/">discovery</a> <a class="post-tag" href="/tags/edr/">edr</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
